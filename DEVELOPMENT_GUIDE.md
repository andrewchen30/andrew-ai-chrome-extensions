# Andrew's AI-Box 開發與協作指南

這份文件旨在定義 **Andrew's AI-Box** 的開發標準、架構模式以及我們（User 與 AI）之間的協作協議。長期遵循此指南將確保功能的穩定擴展與視覺風格的一致性。

## 1. 核心架構：工具箱模式 (Toolbox Pattern)

擴充功能被設計為一個整合式的「工具箱」，每個新功能應遵循以下結構：

-   **隔離性**：功能之間應儘量獨立。
-   **入口點**：
    -   `popup/`: 功能的狀態顯示與快速開關。
    -   `options/`: 功能的詳細設定介面。
    -   `content/`: 需與網頁互動的腳本 (如攔截器)。
-   **數據持久化**：統一使用 `chrome.storage.sync` 進行設定儲存，確保跨裝置同步。

## 2. 視覺設計標準 (Design System)

為了維持沈穩且高品質的質感，所有新介面必須遵循以下 Airbnb 啟發的規範：

### 核心調色盤
-   **Primary (主色)**: `#eba434` (琥珀色) - 用於主要按鈕、圖標、進度條。
-   **Text Main**: `#222222` - 用於標題與主要內容。
-   **Text Secondary**: `#717171` - 用於說明文字與標籤。
-   **Background**: `#ffffff` (全白) 與 `#f7f7f7` (淺灰背景)。
-   **Border**: `#dddddd` (極細邊框)。

### 佈局規範
-   **單位標準**：禁止使用 `rem` 或 `em`，必須使用 **絕對像素 `px`** 以避免受宿主網站字體設定影響。
-   **圓角**: `8px` (內部元素) / `12px` (卡片) / `16px` (大型容器)。
-   **陰影**: `0 6px 16px rgba(0, 0, 0, 0.08)` (Airbnb 軟陰影)。

## 3. 功能迭代溝通協議

當你要求新增功能時，我們將遵循以下溝通流程：

1.  **功能定義**：明確該功能是屬於「攔截型」、「輔助型」還是「快捷型」。
2.  **設計確認**：我會先確保 UI 符合上述 Design System。
3.  **配置化**：新功能必須具備「可設定性」，並在 `options` 頁面提供對應的控制選項。
4.  **架構標準 (Shadow DOM Single File)**：
    -   **單一檔案原則**：功能邏輯與樣式必須合併於單一 `.js` 檔案中 (位於 `features/xxx/xxx.js`)。
    -   **禁止額外 CSS**：樣式必須以 Template String 形式寫在 JS 內，並注入到 Shadow DOM。
    -   **隔離性**：必須使用 `attachShadow({mode: 'open'})` 來隔離樣式，防止污染或被污染。
5.  **測試計畫標準**：
    -   每個功能資料夾必須包含 `TEST_PLAN.md`，詳細說明觸發條件與手動驗證步驟。

## 4. 程式碼規範與品質

-   **命名空間**：即使在 Shadow DOM 內，建議 Host ID 使用 `andrew-` 前綴。
-   **異步處理**：所有與內容腳本相關的操作應確保 `document.documentElement` 已準備就緒。
-   **圖標標準**：採用純色、細線條 (Thin-line art) 風格，主色統一使用 `#eba434`。

---

## 5. 如何向我提出新需求？

-   **範例**：「我想新增一個『翻譯功能』，請在 Popup 增加一個開關，並在 Options 網頁讓我設定目標語言。」
-   **我的回應**：我會檢查是否符合設計標準，並在不破壞現有「專注攔截器」的情況下擴展功能。

*版本：1.0 | 更新日期：2026-01-01*
